<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
    <button onclick="ajax()">Ajax ìš”ì²­</button>

    <script>
        /* 
            ë¹„ë™ê¸° - ì›¹í˜ì´ì§€ ì´ë™ ì—†ì´ ë°ì´í„°ë§Œ ì£¼ê³ ë°›ëŠ” ê¸°ìˆ 
            fetch()ë¥¼ í˜¸ì¶œí•˜ë©´ Promiseë¥¼ ë°˜í™˜

            Promise
            - pending : ìˆ˜í–‰ì¤‘
            - fullfiled : ì„±ê³µ
            - reject : ì‹¤íŒ¨

            1. ë¦¬í„´ Promiseë¼ë©´ then(ì½œë°±í•¨ìˆ˜) ë¡œ ê²°ê³¼ë¥¼ ë°›ì„ ìˆ˜ ìˆìŒ
        */

        function ajax() {

            //1st
          /*   
                var result = fetch("hi.txt"); //Promise ê°ì²´
                console.log(result); //Promise ê°ì²´ í™•ì¸
                // function(response) {} - ì½œë°±í•¨ìˆ˜(ìµëª…í•¨ìˆ˜), ë§¤ê°œë³€ìˆ˜ë¡œ í•¨ìˆ˜ë¥¼ ë„£ì–´ì¤Œ
                result.then(function(res) {
                    console.log(res);
                }) 
            */

            //2nd - í•œë²ˆì— ì“°ê¸°
            /* 
                fetch("hi.txt")
                .then(function(response) {

                    if(response.status != 200) {
                        alert("í†µì‹ ì— ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                        return; //í•¨ìˆ˜ ì¢…ë£Œ
                    }
                    // var a = response.text(); 
                    // console.log(a); //aëŠ” Promise ê°ì²´ ë‚˜ì˜´
                    response.text()
                    .then(function(data) {
                        console.log(data); //ì´ê±° ë¹„ë™ê¸°ì•¼~ text ë‚´ìš© ë‚˜ì˜´, í™”ë©´ ë¡œë”©ì—†ì´ ë°ì´í„°ë§Œ ë™ì ìœ¼ë¡œ ê°€ì ¸ì˜´
                    })
                }) 
            */

           //3rd - ì½œë°±ì— ë¦¬í„´ì„ ê±¸ë©´ fetchê°€ ë‹¤ì‹œ Promiseë¥¼ ë°˜í™˜
         /*   
            fetch("hi.txt").then(function(res) {
                    
                    //callback í•¨ìˆ˜ì˜ returnìœ¼ë¡œ 
                    return res.text(); //res.text()ì˜ ê²°ê³¼ê°€ ë‹¤ì‹œ fetchë¡œ ëŒì•„ê° â–¶ Promise ê°ì²´ ë‚˜ì˜´

                }).then(function(data) { //ì—¬ê¸°ì„œ data ì°ìŒ
                    console.log(data);
                })
            */

            //4nd - ë¹„ë™ê¸°ë°©ì‹ì—ëŠ” ìˆœì„œë¥¼ ë³´ì¥í•˜ì§€ ì•ŠìŒğŸ‘€
            /* ex) log2ì˜ ë°ì´í„°ë¥¼ ê°€ì§€ê³  log3ì—ì„œ í•¨ìˆ˜ë¥¼ ë§Œë“¤ë©´ ì§„í–‰ë˜ì§€ ì•ŠìŒ
               3ë²ˆì´ ë¨¼ì € ì‹¤í–‰ë˜ëŠ”ë° 2ë²ˆì´ ìˆì„ì§€ ì•Œ ìˆ˜ ì—†ìŒ
               1 â–¶ 3 â–¶ 2 ë‚˜ì˜´ */
            
            console.log(1);

            fetch("hi.txt")

            .then(function(response) {
                return response.text();
            })
            .then(function(data) {
                console.log(2);
            })
            console.log(3);

        }


        /* 
            3rd
            res, response ë°›ê³  ê·¸ ì•ˆì— text()ìˆìŒ
            return res.text() í•˜ë©´ ê²°ê³¼ê°€ Promise ê°ì²´ê°€ ë‚˜ì˜´ = fetch("hi.txt")í•˜ë©´ì„œ 
            .thení•˜ë©´ ì½œë°±í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜(=data)ë¡œ hi.txtê°€ ë“¤ì–´ê°€ë©´ì„œ return hi.txtê°€ ë‚˜ì˜´

            text() - ë°ì´í„°ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜
        */

/*         function myfetch(req) { 
            //ë¹„ë™ê¸°ì  ì‹¤í–‰.. 10ì´ˆ..
            return new Promise(function(succes, fail) {
                succes("ëŒ€ì‹ ì‹¤í–‰")
            }) 
        }

        var result = myfetch('aaaa');
        result.then(function(res) {
            console.log(res);
        });

        new Promise(function(succes, fail) {
                succes("ëŒ€ì‹ ì‹¤í–‰");
                // throw new Error("dffs")
        }).then(function(data) { //success
            console.log(data);
        }).catch(function(err) { //error
            console.log(err);
        }) */
 
    </script>

</body>
</html>